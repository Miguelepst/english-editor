# ============================================================
# üì¶ METADATOS DEL BUILD SYSTEM
# Define c√≥mo setuptools construye tu paquete desde el c√≥digo fuente.
# ============================================================
[build-system]
requires = ["setuptools>=61.0", "wheel"]      # Dependencias para construir el paquete
build-backend = "setuptools.build_meta"       # Backend est√°ndar de Python moderno

# ============================================================
# üß© METADATOS DEL PROYECTO
# Informaci√≥n esencial para pip, PyPI y herramientas de packaging.
# ‚ö†Ô∏è IMPORTANTE: 'name' usa guiones bajos (_) para evitar conflictos
#    con el sistema de imports de Python (PEP 508).
#    Ej: "english-editor" ‚Üí "english_editor" en imports.
# ============================================================
[project]
name = "english_editor"                        # ‚úÖ Normalizado: guiones ‚Üí guiones bajos # name = "english_editor"
version = "0.1.0"
description = "Modular Monolith Scaffold ‚Äî Vertical Slice Architecture"
readme = "README.md"
requires-python = ">=3.9"                      # Versi√≥n m√≠nima de Python requerida
license = {text = "MIT"}                     # Licencia est√°ndar para proyectos abiertos, ‚úÖ Las llaves dobles se convierten en literales en el output
authors = [
  {name = "Developer", email = "developer@example.com"}
]
dependencies = [
    "librosa>=0.10.0",
    "numpy>=1.24.0",
    "soundfile>=0.12.0",
]                              # Dependencias de producci√≥n (vac√≠o inicial)




optional-dependencies.dev = [                  # Dependencias de desarrollo (opcionales)
  "pytest>=8.0.0",                             # Framework de testing est√°ndar industria
  "pytest-cov>=4.0",                           # Cobertura de c√≥digo integrada
  "psutil>=5.9",                               # ‚Üê Agregar esta l√≠nea  
  "pytest-sugar>=0.9",                         # Mejora visual de salida (opcional)
  "pytest-mock>=3.12.0",
  "pytest-timeout>=2.3.0",
  "pytest-benchmark>=5.2.3",                   # Pruebas de rendimiento, # Dejarlo libre obliga a pip a traer la m√°s actual compatible
                                               # (>=5.2.3) proteger tu proyecto de car al futuro.
                                               # Ahora s√≠ tienes un valor real y justificado
  "pip-tools>=7.0",       # Si en el futuro quieres reproducibilidad exacta (como un lock file), puedes agregar pip-tools
  "ruff>=0.1",                                 # Linter + formateador moderno (100x m√°s r√°pido)
  "mypy>=1.0",                                 # Type checking est√°tico estricto
  "rich>=13.0",                                # Salida de consola bonita para demos
]



# ============================================================
# üîç DESCUBRIMIENTO DE PAQUETES
# Indica a setuptools d√≥nde buscar el c√≥digo fuente.
# Patr√≥n 'src/' layout: c√≥digo en src/<package_name>/
# ============================================================
[tool.setuptools.packages.find]
where = ["src"]                                # Buscar paquetes dentro de src/

# ============================================================
# üß™ CONFIGURACI√ìN DE PYTEST
# Opciones predeterminadas para ejecuci√≥n de tests.
# ============================================================
[tool.pytest.ini_options]
pythonpath = ["src"]                           # Agrega src/ al PYTHONPATH autom√°ticamente
testpaths = ["tests"]                          # Directorios donde buscar tests
markers = [
  "unit: Tests unitarios r√°pidos (mocks, sin I/O real)",
  "integration: Tests de integraci√≥n (lentos, requieren ML y dependencias externas)",
  "e2e: pruebas end-to-end",
  "slow: Tests que tardan m√°s de 1 segundo",
  "performance: Benchmarks y pruebas de carga o recursos"  # <--- AGREGAR ESTA
]

addopts = [
  "-v",                                         # Modo verbose (muestra nombre de cada test)
#  "--strict-markers",                          # Requiere que todos los markers est√©n definidos
#  "--tb=short",                                # Traceback conciso en fallos
#  "--cov=src/english_editor",                  # Medir cobertura solo en c√≥digo fuente
#  "--cov-report=term-missing",                 # Mostrar l√≠neas no cubiertas en terminal
#  "--cov-report=html:htmlcov",                 # Generar reporte HTML interactivo
#  "--cov-fail-under=80"                        # Fallar si cobertura < 80%
]
console_output_style = "progress"              # Barra de progreso visual durante tests
xfail_strict = true                            # Tests marcados xfail deben fallar expl√≠citamente

# Timeout global para tests (evita tests infinitos)
timeout = 300


# Ignorar advertencias espec√≠ficas
filterwarnings = [
    "ignore::UserWarning:huggingface_hub.utils._auth",
    "ignore::DeprecationWarning",
]

# ============================================================
# üßπ LINTING CON RUFF
# Reemplaza flake8 + black + isort en una sola herramienta r√°pida.
# ============================================================
#[tool.ruff]
#line-length = 88                               # Est√°ndar PEP 8 (compatible con Black)
#target-version = "py39"                        # Versi√≥n m√≠nima de Python a soportar
#select = ["E", "F", "W", "I", "UP", "C4", "TID", "RUF"]  # Reglas activas:
                                                   # E/F/W: Errores Pyflakes/PyCodeStyle
                                                   # I: Import sorting (isort)
                                                   # UP: Pyupgrade (moderniza sintaxis)
                                                   # C4: Comprehension mejoradas
                                                   # TID: Clean code (nombres, etc.)
                                                   # RUF: Reglas espec√≠ficas de Ruff
#ignore = ["E501"]                              # Ignorar longitud de l√≠nea (Ruff la formatea)

#[tool.ruff.format]
#quote-style = "double"                         # Comillas dobles consistentes
#indent-style = "space"                         # Espacios (no tabs)
#skip-magic-trailing-comma = false              # Mantener comas finales para diffs limpios

# ============================================================
# üî§ TYPE CHECKING CON MYPY
# Fuerza type hints desde el inicio para c√≥digo mantenible.
# ============================================================
#[tool.mypy]
#python_version = "3.9"
#warn_return_any = true                         # Advertir si una funci√≥n retorna 'Any'
#warn_unused_configs = true                     # Detectar configuraci√≥n mypy no usada
#disallow_untyped_defs = true                   # Requerir type hints en todas las funciones
#check_untyped_defs = true                      # Verificar cuerpo de funciones sin hints
#no_implicit_optional = true                    # Requerir Optional[T] expl√≠cito
#strict_equality = true                         # Advertir comparaciones de tipos incompatibles

# ============================================================
# üìä CONFIGURACI√ìN DE COBERTURA
# Reglas avanzadas para medici√≥n de cobertura de c√≥digo.
# ============================================================
#[tool.coverage.run]
#source = ["src/english_editor"]                # Solo medir c√≥digo fuente (no tests)
#branch = true                                  # Medir cobertura de branches (if/else)
#parallel = true                                # Soporte para tests paralelos

#[tool.coverage.report]
#fail_under = 80                                # Fallar si cobertura total < 80%
#show_missing = true                            # Mostrar l√≠neas no cubiertas
#skip_covered = true                            # Ocultar archivos 100% cubiertos
#exclude_lines = [
#  "pragma: no cover",                          # Excluir bloques marcados expl√≠citamente
#  "if __name__ == .__main__.:",
#  "raise NotImplementedError",
#]